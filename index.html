<html>
    <head> 
        <title>
            Controller Input
        </title>
        <link rel="stylesheet" href="static/style.css"/>
    </head>
    <body>
            <div class="main">

                <div class="shoulder">
                    <div class="L-shoulder">
                        <div id="LB">
                            <svg xmlns="http://www.w3.org/2000/svg"
                                width="0.61in" height="0.223333in"
                                viewBox="0 0 183 67">
                            <path id="LB"
                                    fill="black" stroke="black" stroke-width="1"
                                    d="M 0.00,67.00
                                    C 12.18,56.27 34.46,48.51 50.00,43.33
                                        90.96,29.68 139.88,22.00 183.00,22.00
                                        177.49,19.64 170.85,20.21 161.00,15.51
                                        151.38,10.92 147.85,4.67 143.00,2.31
                                        138.95,0.35 126.97,0.95 122.00,1.00
                                        97.59,1.29 62.81,12.36 42.00,24.92
                                        36.87,28.02 28.68,34.49 24.00,38.44
                                        16.91,44.42 2.20,58.12 0.00,67.00 Z" />
                            </svg>
                        </div>
                    </div>
                    <div class="R-shoulder">
                        <div id="RB">
                            <svg xmlns="http://www.w3.org/2000/svg"
                                width="0.61in" height="0.22in"
                                viewBox="0 0 183 66">
                            <path id="RB"
                                    fill="black" stroke="black" stroke-width="1"
                                    d="M 0.00,20.00
                                    C 3.43,21.36 6.37,20.96 10.00,21.00
                                        10.00,21.00 20.00,21.91 20.00,21.91
                                        20.00,21.91 42.00,23.17 42.00,23.17
                                        76.21,26.44 113.82,34.95 146.00,46.95
                                        156.09,50.71 175.52,57.77 182.00,66.00
                                        182.93,61.37 178.57,57.28 175.71,54.00
                                        168.33,45.51 159.85,37.92 151.00,31.01
                                        128.34,13.34 87.81,0.04 59.00,0.00
                                        59.00,0.00 50.00,0.00 50.00,0.00
                                        34.78,0.02 37.87,4.79 26.00,12.29
                                        18.65,16.93 8.65,19.60 0.00,20.00 Z" />
                            </svg>
                        </div>
                    </div>
                </div>
                <div class="controller">
                    <img src="static/xbox-full-main.svg">
                    <div class="center">

                    </div>

                    <div class="d-pad">
                        <div class="relative-d-pad">
                            <div id="up">
                                <svg xmlns="http://www.w3.org/2000/svg"
                                    width="0.153333in" height="0.23in"
                                    viewBox="0 0 46 69">
                                <path id="dpad up"
                                        fill="black" stroke="black" stroke-width="1"
                                        d="M 14.00,0.59
                                        C 10.40,1.02 4.16,1.54 1.74,4.43
                                            -0.69,7.33 0.00,15.19 0.00,19.00
                                            0.00,24.27 -0.57,44.37 0.72,48.00
                                            1.82,51.07 4.88,54.61 7.09,57.00
                                            10.96,61.18 17.82,69.47 24.00,68.73
                                            28.50,68.19 32.95,63.15 35.96,60.00
                                            38.51,57.34 44.03,51.28 45.26,48.00
                                            46.29,45.27 46.00,39.14 46.00,36.00
                                            46.00,36.00 46.00,12.00 46.00,12.00
                                            45.99,9.32 46.22,5.80 44.26,3.70
                                            42.37,1.67 38.62,1.19 36.00,0.59
                                            29.86,-0.27 20.18,-0.34 14.00,0.59 Z" />
                                </svg>
                            </div>
                            <div id="right">
                                <svg xmlns="http://www.w3.org/2000/svg"
                                    width="0.23in" height="0.153333in"
                                    viewBox="0 0 69 46">
                                <path id="dpad right"
                                        fill="black" stroke="black" stroke-width="1"
                                        d="M 21.00,0.72
                                        C 15.23,3.49 1.03,15.59 0.27,22.00
                                            -0.29,26.68 3.02,29.93 6.02,33.00
                                            9.47,36.55 17.35,44.31 22.00,45.86
                                            23.87,46.08 27.00,46.00 29.00,45.86
                                            29.00,45.86 56.00,45.86 56.00,45.86
                                            58.88,46.00 63.06,46.35 65.30,44.26
                                            68.36,41.40 68.98,31.13 69.00,27.00
                                            69.03,21.17 69.18,5.60 64.57,1.74
                                            62.47,-0.02 59.59,0.04 57.00,0.00
                                            49.72,-0.10 26.72,-0.62 21.00,0.72 Z" />
                                </svg>
    
                            </div>
                            <div id="down">
                                <svg xmlns="http://www.w3.org/2000/svg"
                                    width="0.153333in" height="0.23in"
                                    viewBox="0 0 46 69">
                                <path id="dpad down"
                                        fill="black" stroke="black" stroke-width="1"
                                        d="M 20.00,0.74
                                        C 14.54,3.58 2.92,15.20 0.74,21.00
                                            -0.07,23.14 0.01,25.74 0.00,28.00
                                            0.00,28.00 0.00,58.00 0.00,58.00
                                            0.03,60.10 -0.03,62.77 1.17,64.58
                                            4.39,69.41 19.57,69.02 25.00,69.00
                                            29.61,68.98 41.25,68.18 44.26,64.57
                                            46.31,62.12 46.00,58.03 46.00,55.00
                                            46.00,55.00 46.00,29.00 46.00,29.00
                                            45.99,23.68 46.27,21.59 43.06,17.00
                                            40.29,13.05 30.28,2.31 26.00,0.74
                                            23.56,-0.15 22.37,0.23 20.00,0.74 Z" />
                                </svg>
    
                            </div>
                            <div id="left">
                                <svg xmlns="http://www.w3.org/2000/svg"
                                    width="0.23in" height="0.153333in"
                                    viewBox="0 0 69 46">
                                <path id="dpad left"
                                        fill="black" stroke="black" stroke-width="1"
                                        d="M 5.22,0.74
                                        C -1.66,5.56 -0.52,26.24 0.75,34.00
                                            1.22,36.86 1.78,41.37 3.72,43.57
                                            6.08,46.24 9.76,45.98 13.00,46.00
                                            13.00,46.00 40.00,46.00 40.00,46.00
                                            51.47,45.98 54.14,41.96 62.00,34.00
                                            64.73,31.23 68.25,28.07 68.73,24.00
                                            69.29,19.32 65.98,16.07 62.98,13.00
                                            56.90,6.75 51.12,0.13 42.00,0.00
                                            34.99,-0.09 10.46,-0.65 5.22,0.74 Z" />
                                </svg>
    
                            </div>
                            
                        </div>
                        
                    
                    </div>
                    <div class="L-axis">
                        <svg xmlns="http://www.w3.org/2000/svg"
                            width="0.31in" height="0.31in"
                            viewBox="0 0 93 92">
                        <path id="Selection"
                                fill="black" stroke="black" stroke-width="1"
                                d="M 42.00,0.26
                                C 30.27,2.35 21.69,5.21 13.09,14.04
                                    -15.20,43.10 5.27,89.64 45.00,91.91
                                    48.98,92.14 56.10,90.90 60.00,89.84
                                    98.92,79.25 104.17,26.71 70.00,6.45
                                    63.60,2.66 55.43,0.52 48.00,0.26
                                    45.57,-0.05 44.35,0.14 42.00,0.26 Z" />
                        </svg>

                    </div>
                    <div class="R-axis">
                        <svg xmlns="http://www.w3.org/2000/svg"
                            width="0.31in" height="0.31in"
                            viewBox="0 0 93 92">
                        <path id="Selection"
                                fill="black" stroke="black" stroke-width="1"
                                d="M 42.00,0.26
                                C 30.27,2.35 21.69,5.21 13.09,14.04
                                    -15.20,43.10 5.27,89.64 45.00,91.91
                                    48.98,92.14 56.10,90.90 60.00,89.84
                                    98.92,79.25 104.17,26.71 70.00,6.45
                                    63.60,2.66 55.43,0.52 48.00,0.26
                                    45.57,-0.05 44.35,0.14 42.00,0.26 Z" />
                        </svg>

                    </div>

                </div>
                
            </div>
        


        <script>
            window.addEventListener("gamepadconnected", (e) => {
                const gp = navigator.getGamepads()[e.gamepad.index];
                console.log(
                    `Gamepad connected at index ${gp.index}: ${gp.id} with ${gp.buttons.length} buttons, ${gp.axes.length} axes.`,
                );
                console.log(navigator.getGamepads())    
                });

            function updateGamepadState() {
                const gamepads = navigator.getGamepads();

                for (const gamepad of gamepads) {
                    if (gamepad) {
                    // Access button states
                        for (let i = 0; i < gamepad.buttons.length; i++) {
                            if (i == 4) {
                                if (gamepad.buttons[i].pressed) {
                                    console.log("button 5 pressed");
                                    document.getElementById('LB').querySelector('svg').querySelector('path').style.fill = 'red'
                                    document.getElementById('LB').querySelector('svg').querySelector('path').style.stroke = 'red'
                                }
                                else {
                                    document.getElementById('LB').querySelector('svg').querySelector('path').style.fill = 'black'
                                    document.getElementById('LB').querySelector('svg').querySelector('path').style.stroke = 'black'
                                }
                                
                            }
                            else if (i == 5) {
                                if (gamepad.buttons[i].pressed) {
                                    console.log("button 5 pressed");
                                    document.getElementById('RB').querySelector('svg').querySelector('path').style.fill = 'red'
                                    document.getElementById('RB').querySelector('svg').querySelector('path').style.stroke = 'red'
                                }
                                else {
                                    document.getElementById('RB').querySelector('svg').querySelector('path').style.fill = 'black'
                                    document.getElementById('RB').querySelector('svg').querySelector('path').style.stroke = 'black'
                                }
                                
                            }
                            else if (i==12) {
                                if (gamepad.buttons[i].pressed) {
                                    document.getElementById('up').querySelector('svg').querySelector('path').style.fill = 'red'
                                    document.getElementById('up').querySelector('svg').querySelector('path').style.stroke = 'red'
                                }
                                else {
                                    document.getElementById('up').querySelector('svg').querySelector('path').style.fill = 'black'
                                    document.getElementById('up').querySelector('svg').querySelector('path').style.stroke = 'black'
                                }
                               
                            }
                            else if (i==13) {
                                if (gamepad.buttons[i].pressed) {
                                    document.getElementById('down').querySelector('svg').querySelector('path').style.fill = 'red'
                                    document.getElementById('down').querySelector('svg').querySelector('path').style.stroke = 'red'
                                }
                                else {
                                    document.getElementById('down').querySelector('svg').querySelector('path').style.fill = 'black'
                                    document.getElementById('down').querySelector('svg').querySelector('path').style.stroke = 'black'
                                }
                               
                            }
                            else if (i==14) {
                                if (gamepad.buttons[i].pressed) {
                                    document.getElementById('left').querySelector('svg').querySelector('path').style.fill = 'red'
                                    document.getElementById('left').querySelector('svg').querySelector('path').style.stroke = 'red'
                                }
                                else {
                                    document.getElementById('left').querySelector('svg').querySelector('path').style.fill = 'black'
                                    document.getElementById('left').querySelector('svg').querySelector('path').style.stroke = 'black'
                                }
                               
                            }
                            else if (i==15) {
                                if (gamepad.buttons[i].pressed) {
                                    document.getElementById('right').querySelector('svg').querySelector('path').style.fill = 'red'
                                    document.getElementById('right').querySelector('svg').querySelector('path').style.stroke = 'red'
                                }
                                else {
                                    document.getElementById('right').querySelector('svg').querySelector('path').style.fill = 'black'
                                    document.getElementById('right').querySelector('svg').querySelector('path').style.stroke = 'black'
                                }
                               
                            }
                            
                            
                        }

                        // Access axes values
                        for (let i = 0; i < gamepad.axes.length; i++) {
                            // console.log(`Axis ${i}: ${gamepad.axes[i]}`);

                            lAxis = document.querySelector('.L-axis')
                            rAxis = document.querySelector('.R-axis')

                            
                            lAxis.style.transform = `translate(${6*gamepad.axes[0] +"px"}, ${6*gamepad.axes[1]+"px"} ) rotate3d(0,1,0,${30*gamepad.axes[0]}deg) rotate3d(-1,0,0,${30*gamepad.axes[1]}deg)`;
                            rAxis.style.transform = `translate(${6*gamepad.axes[2] +"px"}, ${6*gamepad.axes[3]+"px"} ) rotate3d(0,1,0,${30*gamepad.axes[2]}deg) rotate3d(-1,0,0,${30*gamepad.axes[3]}deg)`;

                            if (gamepad.axes[0]**2 + gamepad.axes[1]**2 > .09) {
                                lAxis.querySelector('svg').querySelector('path').style.fill = 'red'
                                lAxis.querySelector('svg').querySelector('path').style.stroke = 'red'
                            }
                            else {
                                lAxis.querySelector('svg').querySelector('path').style.fill = 'black'
                                lAxis.querySelector('svg').querySelector('path').style.stroke = 'black'
                            }
                            if (gamepad.axes[2]**2 + gamepad.axes[3]**2 > .09) {
                                rAxis.querySelector('svg').querySelector('path').style.fill = 'red'
                                rAxis.querySelector('svg').querySelector('path').style.stroke = 'red'
                            }
                            else {
                                rAxis.querySelector('svg').querySelector('path').style.fill = 'black'
                                rAxis.querySelector('svg').querySelector('path').style.stroke = 'black'
                            }
                            
                            
                        }
                    }
                }

                requestAnimationFrame(updateGamepadState);
            }

            updateGamepadState();

                
            
        </script>
    </body>
</html>